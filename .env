// Remova qualquer código de rota que você tenha aqui para os usuários
// e adicione os middlewares e o roteador de usuários

// ... seus imports existentes
const app = express();
const mongoose = require("mongoose");
const cors = require("cors");
const dotenv = require("dotenv");

// Carrega as variáveis de ambiente
dotenv.config();

// Imports das suas rotas
const produtoRoutes = require("./routes/produtos");
const usuarioRoutes = require("./routes/usuarios");

// Middleware para processar JSON e CORS
app.use(express.json());
app.use(cors());

// Conexão com o Banco de Dados
mongoose.connect(process.env.DATABASE_URL, {
  useNewUrlParser: true,
  useUnifiedTopology: true,
}).then(() => console.log("Conectado ao MongoDB")).catch(err => console.error(err));

// Use as rotas
app.use("/api/produtos", produtoRoutes);
app.use("/api/usuarios", usuarioRoutes);

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => console.log(`Servidor rodando na porta ${PORT}`));